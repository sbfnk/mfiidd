<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Particle MCMC</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="mfiidd.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MFIIDD 2023</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="introduction.html">Introduction</a>
</li>
<li>
  <a href="mcmc.html">MCMC</a>
</li>
<li>
  <a href="mcmc_diagnostics.html">Diagnostics</a>
</li>
<li>
  <a href="play_with_seitl.html">Modelling interlude</a>
</li>
<li>
  <a href="mcmc_and_model_comparison.html">Model comparison</a>
</li>
<li>
  <a href="pmcmc.html">Particle MCMC</a>
</li>
<li>
  <a href="ABC.html">ABC</a>
</li>
<li>
  <a href="further_methods.html">Further methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-envelope-o"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/sbfnk/mfiidd">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Particle MCMC</h1>

</div>


<p><a href="slides/smc.pdf">Lecture slides</a></p>
<div id="objectives" class="section level1">
<h1>Objectives</h1>
<p>The aim of this session is to learn how you can fit a stochastic model using the particle MCMC Metropolis-Hastings algorithm (pMCMC). As you saw in the lecture, fitting a model with a likelihood approach requires:</p>
<ul>
<li>To explore the parameter space efficiently</li>
<li>To evaluate the likelihood at a given parameter</li>
</ul>
<p>In the <a href="mcmc_and_model_comparison.html">previous session</a>, you have used the function <code>mcmcMh</code> to explore the parameter space with the Metropolis-Hastings algorithm and the function <code>dTrajObs</code> to evaluate the likelihood for your deterministic model. In order to fit a stochastic model, we can still use the <code>mcmcMh</code> function to explore the parameter space efficiently but we need to use a new function to evaluate the likelihood. This new function is called a particle filter.</p>
<p>In this session you will:</p>
<ol style="list-style-type: decimal">
<li>code a particle filter to estimate the likelihood of a stochastic model</li>
<li>learn how to calibrate the number of particles</li>
<li>fit the stochastic SEIT4L model to the Tristan da Cunha outbreak with pMCMC</li>
</ol>
</div>
<div id="code-a-particle-filter" class="section level1">
<h1>Code a particle filter</h1>
<p>Before running pMCMC, we need to code a particle filter in order to evaluate the log-likelihood of the data at a given proposed <code>theta</code>.</p>
<p>Below you can find the skeleton of such a function. We have inserted comments at each step of the algorithm. If you are struggling at any point, follow the link below the code for a more guided example.</p>
<pre class="r"><code># This is a function that takes four parameters:
# - fitmodel: a fitmodel object
# - theta: named numeric vector. Values of the parameters for which the marginal log-likelihood is desired.
# - initState: named numeric vector. Initial values of the state variables.
# - data: data frame. Observation times and observed data.
# The function returns the value of the marginal log-likelihood
my_particleFilter &lt;- function(fitmodel, theta, initState, data, nParticles) {

    ## Initialisation of the algorithm
    # Initialise the state and the weight of your particles

    ## Start for() loop over observation times

        # Resample particles according to their weights
        # You can use the `sample() function of R

        ## Start for() loop over particles

            # Propagate the particle from current observation time to the next one
            # using the function `fitmodel$simulate`

            # Weight the particle with the likelihood of the observed data point
            # using the function `fitmodel$dPointObs`

        ## End for() loop over particles

    ## End for() loop over observation times

    ## Compute and return the marginal log-likelihood
    # sum of the log of the mean of the weights at each observation time

}</code></pre>
<p>If you have trouble filling any of the empty bits, have a look at our <a href="smc_example.html">more guided example</a>.</p>
</div>
<div id="run-a-particle-filter" class="section level1">
<h1>Run a particle filter</h1>
<p>Try to run your particle filter with the following inputs:</p>
<pre class="r"><code># load seit4lStoch
data(models)

# load data
data(fluTdc1971)

# theta close to the mean posterior estimate of the deterministic SEIT4L model
theta &lt;- c(R_0 = 7, D_lat = 1, D_inf = 4, alpha = 0.5, D_imm = 10, rho = 0.65)

# init state as before
initState &lt;- c(S = 279, E = 0, I = 2, T1 = 3, T2 = 0, T3 = 0, T4 = 0, L = 0, Inc = 0)

# run the particle filter with 20 particles
my_particleFilter(seit4lStoch, theta, initState, data = fluTdc1971, nParticles = 20)
## [1] -124.5306</code></pre>
<p>Does your particle filter return the same value for the marginal log-likelihood? Can you explain why?</p>
<p>What can you notice when you:</p>
<ul>
<li>Run several replicates with the same number of particles</li>
<li>Increase the number of particles</li>
<li>Decrease the number of particles (try with one particle)</li>
<li>Change <code>theta</code></li>
</ul>
</div>
<div id="calibrate-the-number-of-particles" class="section level1">
<h1>Calibrate the number of particles</h1>
<p>Can you think of and implement an algorithm to calibrate the number of particles?</p>
<p>Compare your approach with <a href="pmcmc_solution.html#calibrate-the-number-of-particles">ours</a> and determine an optimal number of particles.</p>
</div>
<div id="run-pmcmc" class="section level1">
<h1>Run pMCMC</h1>
<p>You can now write a new wrapper for the function <code>dLogPosterior</code> that will take <code>margLogLike = my_particleFilter</code> as argument. This wrapper will then be passed to <code>mcmcMh</code>.</p>
<p>Note that the function <code>dLogPosterior</code> doesn’t have a <code>nParticles</code> argument so you might wonder how to specify it to <code>my_particleFilter</code>? Have a look at the documentation of <code>dLogPosterior</code>. You should notice the <code>...</code> argument, which allows you to pass any extra argument to the function <code>margLogLike</code>.</p>
<p>You have probably noticed that running <code>my_particleFilter</code> is time consuming. As we mentioned in the <a href="mcmc_and_model_comparison.html#objectives">previous session</a> this can lead to a waste of time and computational resources if you initialise the pMCMC with parameter values far from the target and with a Gaussian proposal that is very different from the target.</p>
<p>In order to efficiently initialise your pMCMC, you can make use the results of the fit of the deterministic SEIT4L model of the previous session. Remember that you can load these results as follows:</p>
<pre class="r"><code>
# this should load 2 objects in your environment: mcmcSeit4lInfoPriorTheta1 and
# mcmcSeit4lInfoPriorTheta2. Each one is a list of 3 elements returned by
# mcmcMh
names(mcmcSeit4lInfoPriorTheta1)
## [1] &quot;trace&quot;           &quot;acceptanceRate&quot;  &quot;covmatEmpirical&quot;</code></pre>
<p>In the previous session, you have initialised <code>mcmcMh</code> with a diagonal covariance matrix for the Gaussian proposal using the argument <code>proposalSd</code>. Actually, you can also pass a non-diagonal covariance matrix, accounting for correlations, by using the argument <code>covmat</code> (type <code>?mcmcMh</code> for more details).</p>
<p>You can now set the pMCMC by filling the empty bits below:</p>
<pre class="r"><code># wrapper for posterior
my_posteriorSto &lt;- function(theta){

    my_fitmodel &lt;- # INSERT HERE
    my_initState &lt;- # INSERT HERE

    return(dLogPosterior(fitmodel = my_fitmodel,
                         theta = theta,
                         initState = my_initState,
                         data = fluTdc1971,
                         margLogLike = my_particleFilter,
                         nParticles = nParticles))
    
}

# theta to initialise the pMCMC
initTheta &lt;- # INSERT HERE

# covariance matrix for the Gaussian proposal
covmat &lt;- # INSERT HERE

# lower and upper limits of each parameter (must be named vectors)
lower &lt;- # INSERT HERE
upper &lt;- # INSERT HERE

# number of iterations for the pMCMC
nIterations &lt;- # INSERT HERE

# additional parameters for the adaptive pMCMC, see ?mcmcMh for more details
adaptSizeStart &lt;- # INSERT HERE
adaptSizeCooling &lt;- # INSERT HERE
adaptShapeStart &lt;- # INSERT HERE</code></pre>
<p>If you have trouble filling some of the empty bits, have a look at our <a href="pmcmc_solution.html#setting-the-pmcmc">solution</a>.</p>
<p>Then you should be able to run <code>mcmcMh</code>:</p>
<pre class="r"><code># run the pMCMC
my_pMCMC &lt;- mcmcMh(target = my_posteriorSto(128),
                   initTheta = initTheta,
                   covmat = covmat,
                   limits = list(lower = lower,upper = upper),
                   nIterations = nIterations,
                   adaptSizeStart = adaptSizeStart,
                   adaptSizeCooling = adaptSizeCooling,
                   adaptShapeStart = adaptShapeStart)</code></pre>
</div>
<div id="analyse-a-pmcmc-with-16-particles" class="section level1">
<h1>Analyse a pMCMC with 16 particles</h1>
<p>If you have run a pMCMC you should have noticed that it takes quite a lot of time as we need to run a particle filter at each iteration. Since the computation time scales linearly with the number of particles you might be tempted to reduce this number. Let’s have a look at what we would get by running a pMCMC with 16 particles.</p>
<p>To save time, we have run 8 chains in parallel for you. Each chain was started from a different <code>initTheta</code> and ran for 3000 iterations. The values of <code>initTheta</code> were chosen close to the mean posterior estimates of the deterministic fit and their empirical covariance matrix was also used for the Gaussian proposal kernel. Each chain took 6 hours to complete on a scientific computing cluster and can be loaded as follows:</p>
<pre class="r"><code>data(pmcmcSeit4lInfoPrior)
# this should load a list with the same name, which contains the 8 chains.
length(pmcmcSeit4lInfoPrior16)
## [1] 8
# each chain is a list of 3 elements returned by mcmcMh
names(pmcmcSeit4lInfoPrior16[[1]])
## [1] &quot;trace&quot;           &quot;acceptanceRate&quot;  &quot;covmatEmpirical&quot;
# the trace contains 9 variables for 3000 iterations
dim(pmcmcSeit4lInfoPrior16[[1]]$trace)
## [1] 3000    9</code></pre>
<p>We can combine the traces of the 8 chains into a <code>mcmc.list</code> object as follows:</p>
<pre class="r"><code>library(&quot;coda&quot;)
trace &lt;- mcmc.list(lapply(pmcmcSeit4lInfoPrior16, function(chain) {
    mcmc(chain$trace)
}))
head(trace, 1)
## [[1]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
## [2,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
##      logLikelihood logDensity
## [1,]     -119.7101  -131.0695
## [2,]     -119.7101  -131.0695
## 
## [[2]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm      rho logPrior
## [1,] 9.156946 1.369854 4.422742 0.4634092 10.10724 0.624404 -12.7751
## [2,] 9.156946 1.369854 4.422742 0.4634092 10.10724 0.624404 -12.7751
##      logLikelihood logDensity
## [1,]     -120.8215  -133.5966
## [2,]     -120.8215  -133.5966
## 
## [[3]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
## [2,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
##      logLikelihood logDensity
## [1,]     -122.2201  -133.5796
## [2,]     -122.2201  -133.5796
## 
## [[4]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0   D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 5.205378 1.14665 2.257054 0.4387091 11.13603 0.5932959 -10.03886
## [2,] 5.205378 1.14665 2.257054 0.4387091 11.13603 0.5932959 -10.03886
##      logLikelihood logDensity
## [1,]     -124.2126  -134.2514
## [2,]     -124.2126  -134.2514
## 
## [[5]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 8.059997 1.707677 2.917582 0.4784999 9.896543 0.6653181 -10.10542
## [2,] 8.059997 1.707677 2.917582 0.4784999 9.896543 0.6653181 -10.10542
##      logLikelihood logDensity
## [1,]     -118.9109  -129.0163
## [2,]     -118.9109  -129.0163
## 
## [[6]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
## [2,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
##      logLikelihood logDensity
## [1,]     -118.4847  -129.8442
## [2,]     -118.4847  -129.8442
## 
## [[7]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
## [2,] 7.670397 1.287948 3.711294 0.4749959 9.282156 0.6462679 -11.35949
##      logLikelihood logDensity
## [1,]     -122.5704  -133.9299
## [2,]     -122.5704  -133.9299
## 
## [[8]]
## Markov Chain Monte Carlo (MCMC) output:
## Start = 1 
## End = 2 
## Thinning interval = 1 
##           R_0    D_lat    D_inf     alpha    D_imm       rho  logPrior
## [1,] 7.686268 1.924227 2.114245 0.5073793 8.322857 0.6307255 -9.651117
## [2,] 7.686268 1.924227 2.114245 0.5073793 8.322857 0.6307255 -9.651117
##      logLikelihood logDensity
## [1,]     -122.8299   -132.481
## [2,]     -122.8299   -132.481
## 
## attr(,&quot;class&quot;)
## [1] &quot;mcmc.list&quot;</code></pre>
<p>You can check that the chains were started from different <code>initState</code> and that we used informative priors.</p>
<p><strong>Take 15 min</strong> to analyse these chains and conclude on the choice of using 16 particles to save computation time.</p>
<p>You can compare your conclusions with <a href="pmcmc_solution.html#analyse-a-pmcmc-with-16-particles">ours</a>.</p>
</div>
<div id="analyse-a-pmcmc-with-128-particles" class="section level1">
<h1>Analyse a pMCMC with 128 particles</h1>
<p>Let’s increase the number of particles to 128, which is suggested by the calibration analysis. Again, to save time we have run 8 chains of 3000 iterations in parallel. Each chain took 40 hours to complete on a scientific computing cluster and can be loaded and stored in a <code>mcmc.list</code> object as follows:</p>
<pre class="r"><code># load
data(pmcmcSeit4lInfoPrior)
# create
trace &lt;- mcmc.list(lapply(pmcmcSeit4lInfoPrior128, function(chain) {
    mcmc(chain$trace)
}))</code></pre>
<p>Re-do the same analysis as for 16 particles. What differences can you notice? In particular, try to compare the posterior distributions with 16 and 128 particles using the function <code>plotPosteriorDensity</code>.</p>
<p>You can also have a look at our <a href="pmcmc_solution.html#analyse-a-pmcmc-with-128-particles">solution</a> if that helps.</p>
</div>
<div id="stochastic-vs-deterministic-fit" class="section level1">
<h1>Stochastic vs deterministic fit</h1>
<p>Compare the posterior of the deterministic and stochastic SEIT4L models. Which model provides the best fit? Can you explain why?</p>
<p>Check your answer <a href="pmcmc_solution.html#stochastic-vs-deterministic-fit">here</a>.</p>
</div>
<div id="going-further" class="section level1">
<h1>Going further</h1>
<div id="filtered-trajectories" class="section level2">
<h2>Filtered trajectories</h2>
<ul>
<li>Actually, in addition to the log-likelihood, a particle filter can also return the filtered trajectories (i.e. all the trajectories that “survived” until the last observation time). You can update your filter so it keeps track and returns the filtered trajectories. Alternatively, there is a function in the package called <code>particleFilter</code> that will do it for you (see <code>?particleFilter</code> for documentation). Have a look at its code.</li>
<li>If you run a particle filter with our function <code>particleFilter</code>, you can then plot the filtered trajectories using the function <code>plotSmc</code>.</li>
</ul>
</div>
<div id="optimization" class="section level2">
<h2>Optimization</h2>
<p>You might have noted that the <code>for()</code> loop over particles could be parallelized, as particles can be propagated independently. You could take advantage of this to code a parallel loop and make your algorithm even faster. If you have never coded a parallel program in <strong>R</strong> you can also have a look at the code of <code>particleFilter</code>. Actually, all the test runs were performed on a scientific computing cluster with 12 core machines. So the computational time is expected to be multiplied by 12 without parallelization of the particle filter.</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>A <a href="https://arxiv.org/abs/1703.02419">recent review</a> by Schön et al.</li>
<li>A <a href="https://www.springer.com/gb/book/9780387951461">comprehensive textbook</a> by Doucet et al.</li>
<li>Another <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.117.1144">review</a> by Arulampalam et al.</li>
</ul>
</div>

&nbsp;
<hr />
<p>This web site and the material contained in it were originally created in support of an annual
  short course
  on <a href="https://www.lshtm.ac.uk/study/courses/short-courses/infectious-diseases-dynamics">
  Model Fitting and Inference for Infectious Disease Dynamics</a> at
  the <a href="https://www.lshtm.ac.uk/">London School of Hygiene & Tropical
  Medicine</a>. All material is under
  a <a href="https://github.com/sbfnk/mfiidd/blob/main/LICENSE">MIT
  license</a>. Please report any issues or suggestions for improvement on the
  corresponding <a href="https://github.com/sbfnk/mfiidd/issues">GitHub
  issue tracker</a>. We are always keen to hear about any uses of the material
  here, so please do get in touch using the <a href="https://github.com/sbfnk/mfiidd/discussions">Discussion
  board</a> if you have any questions
  or ideas, or if you find the material here useful or use it in your own
  teaching.
</p>

&nbsp;<script data-goatcounter="https://mfiidd.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
