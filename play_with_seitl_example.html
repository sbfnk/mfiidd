<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Examples: Tristan da Cunha outbreak &amp; the SEITL model</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="mfiidd.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MFIIDD 2023</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="introduction.html">Introduction</a>
</li>
<li>
  <a href="mcmc.html">MCMC</a>
</li>
<li>
  <a href="mcmc_diagnostics.html">Diagnostics</a>
</li>
<li>
  <a href="play_with_seitl.html">Modelling interlude</a>
</li>
<li>
  <a href="mcmc_and_model_comparison.html">Model comparison</a>
</li>
<li>
  <a href="pmcmc.html">Particle MCMC</a>
</li>
<li>
  <a href="ABC.html">ABC</a>
</li>
<li>
  <a href="further_methods.html">Further methods</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-envelope-o"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/sbfnk/mfiidd">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Examples: Tristan da Cunha outbreak &amp; the SEITL model</h1>

</div>


<p>Based on the description of the outbreak above and the information found in the literature we can make the following guess estimates:</p>
<ol style="list-style-type: decimal">
<li>Since the Tristan population is a close knit community, <span class="math inline">\(R_0\)</span> was probably above 2 during the outbreak. Let’s assume <span class="math inline">\(R_0=4\)</span>.</li>
<li>Both the latent (<span class="math inline">\(D_\mathrm{lat}\)</span>) and infectious (<span class="math inline">\(D_\mathrm{inf}\)</span>) periods are equal to 2 days.</li>
<li>The average duration of immunity (<span class="math inline">\(D_\mathrm{imm}\)</span>) is equal to 15 - 2 = 13 days.</li>
<li>Since not all seroconverted individuals acquire a long-term protective against reinfection, let’s assume <span class="math inline">\(\alpha=0.70\)</span></li>
<li>Assuming 80% of symptomatic and 85% of the cases reported in the data, we obtain an overall reporting rate <span class="math inline">\(\rho=0.8\times0.85 \sim 0.7\)</span>.</li>
<li>The 2 islanders with symptoms at disembarkation are infectious: <span class="math inline">\(I(t=0)=2\)</span>.</li>
<li>The 3 islanders who were ill during the 8-day journey are temporary protected at disembarkation: <span class="math inline">\(T(t=0)=3\)</span>.</li>
<li>No islander was immune at the beginning of the epidemic.</li>
</ol>
<p>Now, you can now go back to the <a href="play_with_seitl.html#deterministic-vs-stochastic-simulations">practical</a> and check whether these estimates provides a good fit to the data.</p>
<div id="deterministic-vs-stochastic-simulations" class="section level1">
<h1>Deterministic vs Stochastic simulations</h1>
<div id="deterministic-simulations" class="section level2">
<h2>Deterministic simulations</h2>
<p>Let’s simulate the SEITL model with our initial guess <code>theta</code>:</p>
<pre class="r"><code>thetaGuess1 &lt;- c(R_0 = 4, D_lat = 2, D_inf = 2, alpha = 0.7, D_imm = 13, rho = 0.7)
initStateGuess &lt;- c(S = 279, E = 0, I = 2, T = 3, L = 0, Inc = 0)
plotFit(seitlDeter, thetaGuess1, initStateGuess, data = fluTdc1971, nReplicates = 100)</code></pre>
<p><img src="figure/play_with_seitl_example/guess-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This set of parameters provides a poor fit, in particular the first wave too small. Let’s increase <span class="math inline">\(R_0\)</span>:</p>
<pre class="r"><code>thetaGuess2 &lt;- c(R_0 = 10, D_lat = 2, D_inf = 2, alpha = 0.7, D_imm = 13, rho = 0.7)
plotFit(seitlDeter, thetaGuess2, initStateGuess, data = fluTdc1971, nReplicates = 100)</code></pre>
<p><img src="figure/play_with_seitl_example/guess-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The size of the first wave is now ok but the second wave is too small. Let’s decrease <span class="math inline">\(\alpha\)</span>, thus allowing more islanders to be reinfected:</p>
<pre class="r"><code>thetaGuess3 &lt;- c(R_0 = 10, D_lat = 2, D_inf = 2, alpha = 0.4, D_imm = 13, rho = 0.7)
plotFit(seitlDeter, thetaGuess3, initStateGuess, data = fluTdc1971, nReplicates = 100)</code></pre>
<p><img src="figure/play_with_seitl_example/guess-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is a decent eyeball fit given that we have 6 parameters. However, we note that many data point are not captured by the model, even accounting for variability of the observation process.</p>
<p>Now, you can now go back to the <a href="play_with_seitl.html#stochastic-simulations">practical</a> and check whether the stochastic model provides a better fit to the data.</p>
</div>
<div id="stochastic-simulations" class="section level2">
<h2>Stochastic simulations</h2>
<p>Let’s try the stochastic SEITL model with our best guess from the previous section.</p>
<pre class="r"><code>plotFit(seitlStoch, thetaGuess3, initStateGuess, data = fluTdc1971, nReplicates = 100,
    nonExtinct = c(&quot;E&quot;, &quot;I&quot;))</code></pre>
<p><img src="figure/play_with_seitl_example/guess-3-stoch-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The stochastic model better accounts for the variability in the data. In addition, demographic stochasticity can lead to stochastic extinctions at the beginning and at the end of the outbreak when the number of infectious individuals is low and the chain of transmission can break if by chance they recover before infecting a secondary case. By contrast, the cumulative extinction probability doesn’t increase between the two waves, despite the low incidence observed in the data. Note however that the shape of the second wave is quite flat in comparison to the data.</p>
<p>Now, you can now go back to the <a href="play_with_seitl.html#exponential-vs-erlang-distributions">practical</a> and check how we can make this model a bit more realistic.</p>
</div>
</div>
<div id="exponential-vs-erlang-distributions" class="section level1">
<h1>Exponential vs Erlang distributions</h1>
<p>Let’s simulate the stochastic SEIT4L model with our last guess estimates. Note that we need to change the vector of initial states.</p>
<pre class="r"><code>initStateGuessSEIT4L &lt;- c(S = 279, E = 0, I = 2, T1 = 3, T2 = 0, T3 = 0, T4 = 0,
    L = 0, Inc = 0)
plotFit(seit4lStoch, thetaGuess3, initStateGuessSEIT4L, data = fluTdc1971, nReplicates = 100,
    nonExtinct = c(&quot;E&quot;, &quot;I&quot;))</code></pre>
<p><img src="figure/play_with_seitl_example/guess-3-stoch-SEIT4L-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>With the SEIT4L model the shape of the second epidemic wave is better captured. To explain this, we first note that for the same expected duration, the Erlang distribution with shape <span class="math inline">\(k\)</span> has a variance <span class="math inline">\(k\)</span> times smaller than that of the exponential distribution. Accordingly, recovered individuals stay temporarily protected for similar durations. Consequently, those who do not develop long-term protection go back to the susceptible compartment approximately at the same time. This sudden inflow of susceptible individuals can initiate a bigger second wave.</p>
<p>You’ve already finished? Why not <a href="play_with_seitl.html#going-further">go further</a>?</p>
</div>

&nbsp;
<hr />
<p>This web site and the material contained in it were originally created in support of an annual
  short course
  on <a href="https://www.lshtm.ac.uk/study/courses/short-courses/infectious-diseases-dynamics">
  Model Fitting and Inference for Infectious Disease Dynamics</a> at
  the <a href="https://www.lshtm.ac.uk/">London School of Hygiene & Tropical
  Medicine</a>. All material is under
  a <a href="https://github.com/sbfnk/mfiidd/blob/main/LICENSE">MIT
  license</a>. Please report any issues or suggestions for improvement on the
  corresponding <a href="https://github.com/sbfnk/mfiidd/issues">GitHub
  issue tracker</a>. We are always keen to hear about any uses of the material
  here, so please do get in touch using the <a href="https://github.com/sbfnk/mfiidd/discussions">Discussion
  board</a> if you have any questions
  or ideas, or if you find the material here useful or use it in your own
  teaching.
</p>

&nbsp;<script data-goatcounter="https://mfiidd.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
